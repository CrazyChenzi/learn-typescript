<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript learn</title>
    <meta name="description" content="学习TypeScript所做的笔记(假设你已经了解基础TypeScript)">
    <link rel="icon" href="/learn-typescript/logo.png">
    
    <link rel="preload" href="/learn-typescript/assets/css/0.styles.ad4455ea.css" as="style"><link rel="preload" href="/learn-typescript/assets/js/app.b77f2e63.js" as="script"><link rel="preload" href="/learn-typescript/assets/js/2.58f6d5eb.js" as="script"><link rel="preload" href="/learn-typescript/assets/js/8.62fa3092.js" as="script"><link rel="prefetch" href="/learn-typescript/assets/js/10.87dc1ad2.js"><link rel="prefetch" href="/learn-typescript/assets/js/11.367d0d3e.js"><link rel="prefetch" href="/learn-typescript/assets/js/12.ec3cd9f4.js"><link rel="prefetch" href="/learn-typescript/assets/js/3.af46341e.js"><link rel="prefetch" href="/learn-typescript/assets/js/4.7df84a7c.js"><link rel="prefetch" href="/learn-typescript/assets/js/5.4e4fa213.js"><link rel="prefetch" href="/learn-typescript/assets/js/6.023e01b1.js"><link rel="prefetch" href="/learn-typescript/assets/js/7.6b57c3a0.js"><link rel="prefetch" href="/learn-typescript/assets/js/9.498660ec.js">
    <link rel="stylesheet" href="/learn-typescript/assets/css/0.styles.ad4455ea.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-typescript/" class="home-link router-link-active"><!----> <span class="site-name">TypeScript learn</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/learn-typescript/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/learn-typescript/types/" class="nav-link">Types</a></div><div class="nav-item"><a href="/learn-typescript/typealias/" class="nav-link">TypeAlias</a></div><div class="nav-item"><a href="/learn-typescript/others/" class="nav-link router-link-active">Others</a></div><div class="nav-item"><a href="https://github.com/blacklisten/learn-typescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/learn-typescript/guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/learn-typescript/types/" class="nav-link">Types</a></div><div class="nav-item"><a href="/learn-typescript/typealias/" class="nav-link">TypeAlias</a></div><div class="nav-item"><a href="/learn-typescript/others/" class="nav-link router-link-active">Others</a></div><div class="nav-item"><a href="https://github.com/blacklisten/learn-typescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/learn-typescript/others/" class="sidebar-heading clickable router-link-active open"><span>其它笔记...</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-typescript/others/interfacesDiffTypes.html" class="sidebar-link">Interfaces vs Types</a></li><li><a href="/learn-typescript/others/anyDiffUnknown.html" class="active sidebar-link">Any vs Unknowns</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#any" class="sidebar-link">any</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#unknown类型" class="sidebar-link">unknown类型</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#缩小unknown类型范围" class="sidebar-link">缩小unknown类型范围</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#联合类型中的unknown类型" class="sidebar-link">联合类型中的unknown类型</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#交叉类型中的unknown类型" class="sidebar-link">交叉类型中的unknown类型</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#unknown可以使用的运算符" class="sidebar-link">unknown可以使用的运算符</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#example：-从localstorage中读取json" class="sidebar-link">example： 从localStorage中读取JSON</a></li><li class="sidebar-sub-header"><a href="/learn-typescript/others/anyDiffUnknown.html#references" class="sidebar-link">References</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><code>unknown</code>和<code>nay</code>的主要区别是<code>unknown</code>类型会更加严格，在对<code>unknown</code>类型的值执行大多数操作之前，我们必须进行某种形式的检查。而在对<code>any</code>类型的值执行操作之前，我们不必进行任何检查。</p> <h2 id="any"><a href="#any" class="header-anchor">#</a> any</h2> <p>在<code>TypeScript</code>中，任何类型都可以被归为<code>any</code>类型。这让<code>any</code>类型成为了类型系统的<strong>顶级类型</strong>(也被称作<strong>全局超级类型</strong>)。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>             <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>               <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>    <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>               <span class="token comment">// OK</span>
value <span class="token operator">=</span> Math<span class="token punctuation">.</span>random<span class="token punctuation">;</span>      <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>             <span class="token comment">// OK</span>
value <span class="token operator">=</span> undefined<span class="token punctuation">;</span>        <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// OK</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>我们将<code>value</code>定义为<code>any</code>，<code>TypeScript</code>认为以下所有操作的类型都是正确的</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

value<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">;</span>  <span class="token comment">// OK</span>
value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// OK</span>
<span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// OK</span>
<span class="token keyword">new</span> <span class="token class-name">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// OK</span>
value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">// OK</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="unknown类型"><a href="#unknown类型" class="header-anchor">#</a> unknown类型</h2> <p>就像所有类型都可以被归为<code>any</code>，所有类型也都可以被归为<code>unknown</code>。这使得<code>unknown</code>成为<code>TypeScript</code>类型系统的另一种<code>顶级类型</code>（另一种是<code>any</code>）。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>

value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>             <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>               <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>    <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>               <span class="token comment">// OK</span>
value <span class="token operator">=</span> Math<span class="token punctuation">.</span>random<span class="token punctuation">;</span>      <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>             <span class="token comment">// OK</span>
value <span class="token operator">=</span> undefined<span class="token punctuation">;</span>        <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// OK</span>
value <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// OK</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>我们尝试将<code>unknown</code>赋值给其它类型的变量</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> value1<span class="token punctuation">:</span> <span class="token builtin">unknown</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>   <span class="token comment">// OK</span>
<span class="token keyword">let</span> value2<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>       <span class="token comment">// OK</span>
<span class="token keyword">let</span> value3<span class="token punctuation">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>   <span class="token comment">// Error</span>
<span class="token keyword">let</span> value4<span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token comment">// Error</span>
<span class="token keyword">let</span> value5<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token comment">// Error</span>
<span class="token keyword">let</span> value6<span class="token punctuation">:</span> object <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token comment">// Error</span>
<span class="token keyword">let</span> value7<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>     <span class="token comment">// Error</span>
<span class="token keyword">let</span> value8<span class="token punctuation">:</span> <span class="token builtin">Function</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>  <span class="token comment">// Error</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>unknown</code>类型只能赋值给<code>any</code>和<code>unknown</code>本身</p> <p>我们尝试将<code>unknown</code>赋值给执行操作</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>

value<span class="token punctuation">.</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">;</span>  <span class="token comment">// Error</span>
value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// Error</span>
<span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Error</span>
<span class="token keyword">new</span> <span class="token class-name">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Error</span>
value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">// Error</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>将<code>value</code>设置为<code>unknown</code>后，这些操作都不再是正确的，因此我们必须执行某种类型检查以所小我们正在使用值得范围</p> <h2 id="缩小unknown类型范围"><a href="#缩小unknown类型范围" class="header-anchor">#</a> 缩小<code>unknown</code>类型范围</h2> <p>使用<code>typeof</code>和<code>interface</code>运算符进行范围缩小</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">stringifyForLogging</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">:</span> <span class="token builtin">unknown</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Within this branch, `value` has type `Function`,</span>
    <span class="token comment">// so we can access the function's `name` property</span>
    <span class="token keyword">const</span> functionName <span class="token operator">=</span> value<span class="token punctuation">.</span>name <span class="token operator">||</span> <span class="token string">&quot;(anonymous)&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[function </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>functionName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Within this branch, `value` has type `Date`,</span>
    <span class="token comment">// so we can call the `toISOString` method</span>
    <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>还可以使用自定义保护类型(<code>is</code>)来缩小<code>unknown</code>的范围</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * A custom type guard function that determines whether
 * `value` is an array that only contains numbers.
 */</span>
<span class="token keyword">function</span> <span class="token function">isNumberArray</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">:</span> <span class="token builtin">unknown</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> value <span class="token keyword">is</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
    value<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token keyword">typeof</span> element <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> unknownValue<span class="token punctuation">:</span> <span class="token builtin">unknown</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNumberArray</span><span class="token punctuation">(</span>unknownValue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Within this branch, `unknownValue` has type `number[]`,</span>
  <span class="token comment">// so we can spread the numbers as arguments to `Math.max`</span>
  <span class="token keyword">const</span> max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">...</span>unknownValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="联合类型中的unknown类型"><a href="#联合类型中的unknown类型" class="header-anchor">#</a> 联合类型中的<code>unknown</code>类型</h2> <p><strong>在联合类型中<code>unknown</code>会吸收任何类型，any除外</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> UnionType1 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// unknown</span>
<span class="token keyword">type</span> UnionType2 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">|</span> undefined<span class="token punctuation">;</span>  <span class="token comment">// unknown</span>
<span class="token keyword">type</span> UnionType3 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">;</span>     <span class="token comment">// unknown</span>
<span class="token keyword">type</span> UnionType4 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// unknown</span>
<span class="token keyword">type</span> UnionType5 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">|</span> <span class="token builtin">any</span><span class="token punctuation">;</span>  <span class="token comment">// any</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="交叉类型中的unknown类型"><a href="#交叉类型中的unknown类型" class="header-anchor">#</a> 交叉类型中的<code>unknown</code>类型</h2> <p><strong>在交叉类型中，任何类型都可以吸收<code>unknown</code>类型</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> IntersectionType1 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">&amp;</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// null</span>
<span class="token keyword">type</span> IntersectionType2 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">&amp;</span> undefined<span class="token punctuation">;</span>  <span class="token comment">// undefined</span>
<span class="token keyword">type</span> IntersectionType3 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">&amp;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>     <span class="token comment">// string</span>
<span class="token keyword">type</span> IntersectionType4 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">&amp;</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// number[]</span>
<span class="token keyword">type</span> IntersectionType5 <span class="token operator">=</span> <span class="token builtin">unknown</span> <span class="token operator">&amp;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>        <span class="token comment">// any</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="unknown可以使用的运算符"><a href="#unknown可以使用的运算符" class="header-anchor">#</a> <code>unknown</code>可以使用的运算符</h2> <ul><li><code>===</code></li> <li><code>==</code></li> <li><code>!==</code></li> <li><code>!=</code></li></ul> <p>如果要对类型为<code>unknown</code>的值使用任何其它的运算符，则必须先指定类型</p> <h2 id="example：-从localstorage中读取json"><a href="#example：-从localstorage中读取json" class="header-anchor">#</a> example： 从<code>localStorage</code>中读取JSON</h2> <p>如果该项不存在或者是无效 JSON，则该函数应返回错误结果，否则，它应该反序列化并返回值</p> <p>因为我们不知道在反序列化持久化的 JSON 字符串后我们会得到什么类型的值。我们将使用<code>unknown</code>作为反序列化值的类型。这意味着我们函数的调用者必须在对返回值执行操作之前进行某种形式的检查（或者使用类型断言）</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> Result <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> success<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token builtin">unknown</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> error<span class="token punctuation">:</span> Error <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">tryDeserializeLocalStorageItem</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> Result <span class="token punctuation">{</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The item does not exist, thus return an error result</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      error<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Item with key &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; does not exist</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> value<span class="token punctuation">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>

  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    value <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The item is not valid JSON, thus return an error result</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      error
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Everything's fine, thus return a success result</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    success<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    value
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <p><a href="https://github.com/Microsoft/TypeScript/pull/24439" target="_blank" rel="noopener noreferrer">New 'unknown' top type <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-0-rc-2/#the-unknown-type" target="_blank" rel="noopener noreferrer">RC announcement<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://mariusschulz.com/blog/the-unknown-type-in-typescript" target="_blank" rel="noopener noreferrer">The unknown Type in TypeScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://juejin.im/post/5d04ac745188250a8b1fd203#heading-0" target="_blank" rel="noopener noreferrer">[译] TypeScript 3.0: unknown 类型<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/learn-typescript/others/interfacesDiffTypes.html" class="prev">Interfaces vs Types</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/learn-typescript/assets/js/app.b77f2e63.js" defer></script><script src="/learn-typescript/assets/js/2.58f6d5eb.js" defer></script><script src="/learn-typescript/assets/js/8.62fa3092.js" defer></script>
  </body>
</html>
